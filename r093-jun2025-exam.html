<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>R093/01 June 2025 Full Exam (Markable)</title>
  
  <link href="host.css" rel="stylesheet"/>
  <link href="topic.css" rel="stylesheet"/>
  <link href="nav.css" rel="stylesheet"/>
  <link href="markable-mini-exam.css" rel="stylesheet"/>

<link rel="stylesheet" href="markable-mini-exam.css">
  <style>
    /* Safety styles if your CSS is missing bits */
    .container { max-width: 980px; margin: 0 auto; padding: 18px; }
    .topbar { display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between; }
    .pill { padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.06); }
    .question-card { margin: 14px 0; padding: 14px; border-radius: 14px; background: rgba(255,255,255,0.04); }
    .qhead { display:flex; justify-content:space-between; gap:12px; align-items:flex-start; }
    .qmeta { display:flex; gap:10px; align-items:baseline; }
    .qnum { font-weight:700; }
    .qmarks { opacity:0.9; }
    .qcmd { opacity:0.85; font-size:0.95rem; }
    .qtext { margin-top:10px; white-space:pre-wrap; }
    .qfigure { margin-top:12px; }
    .qfigure img { max-width:100%; border-radius:12px; }
    .answer { margin-top:12px; }
    .answer input[type="text"]{ width:100%; padding:10px; border-radius:10px; }
    .answer textarea{ width:100%; padding:10px; border-radius:10px; min-height:120px; }
    .mcq { display:grid; gap:8px; margin-top:8px; }
    .mcq label{ display:flex; gap:10px; align-items:flex-start; padding:8px 10px; border-radius:12px; background:rgba(255,255,255,0.03); }
    .submit-card { margin-top:18px; padding:16px; border-radius:14px; background: rgba(255,105,180,0.08); border: 1px solid rgba(255,105,180,0.35); }
    .btn-row { display:flex; flex-wrap:wrap; gap:10px; }
    button { cursor:pointer; }
    #examLoadError { display:none; margin: 12px 0; padding: 12px; border-radius: 12px; background: rgba(255,0,0,0.12); border: 1px solid rgba(255,0,0,0.35); }
    .formrow { display:flex; flex-wrap:wrap; gap:10px; margin-top:12px; }
    .formrow input{ flex:1; min-width:240px; padding:10px; border-radius:10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>R093/01 · June 2025 Full Exam</h1>

    <div class="topbar">
      <div class="pill">Total: <strong id="totalMarks">0</strong>/70</div>
      <div class="pill">Timer: <strong id="timer">90:00</strong></div>
      <div class="btn-row">
        <button id="startBtn">Start</button>
        <button id="pauseBtn">Pause</button>
        <button id="saveBtn">Save</button>
        <button id="loadBtn">Load</button>
        <button id="resetBtn">Reset</button>
      </div>
    </div>

    <div class="formrow">
      <input id="studentName" type="text" placeholder="Student name">
      <input id="classCode" type="text" placeholder="Class">
    </div>

    <div id="examLoadError"></div>

    <h2>Answer all questions</h2>

    <section id="questions"></section>

    <div class="submit-card" id="submitCard">
      <p>When finished, click <strong>Submit for marking</strong>.</p>
      <button id="submitAttemptBtn" style="background:#ff4fa1;color:white;border:none;padding:12px 16px;border-radius:12px;font-weight:700;">
        Submit for marking
      </button>
    </div>
  </div>

<script type="module">
  const EXAM_ID = "R093-2025-JUN";
  const LS_KEY = `${EXAM_ID}::answers_v1`;

  const QUESTIONS = [{"id": "JUN25-Q1", "marks": 1, "command_word": "Identify", "text": "Action, arcade, first person, puzzle and RPG are examples of which new media product?", "response_type": "short_text"}, {"id": "JUN25-Q2", "marks": 2, "command_word": "Complete", "text": "Complete the sentences. Write a job role from the list in each of the two spaces.\ncontent creator, graphic designer, web designer, web developer\n\nA ________ is responsible for planning the style and layout of a website.\nA ________ is responsible for creating the website.", "response_type": "short_list", "responses_required": 2}, {"id": "JUN25-Q3", "marks": 1, "command_word": "Select", "text": "Which lighting position is used to create a shadow effect from behind?", "response_type": "mcq_single", "options": ["Back light", "Low angle", "Practical lighting", "Side angle"], "answer": "Back light"}, {"id": "JUN25-Q4", "marks": 2, "command_word": "Identify", "text": "Identify the components of the workplan labelled A and B.", "response_type": "short_list", "responses_required": 2, "figure": {"src": "img/jun_25_04_workplan.jpg", "alt": "Workplan labelled A and B"}}, {"id": "JUN25-Q5", "marks": 1, "command_word": "Identify", "text": "Which intellectual property gives exclusive rights to the creator of a design?", "response_type": "short_text"}, {"id": "JUN25-Q6", "marks": 1, "command_word": "Identify", "text": "Which property of digital audio files counts the number of pieces of data captured each second?", "response_type": "short_text"}, {"id": "JUN25-Q7", "marks": 1, "command_word": "Complete", "text": "Complete the sentence. Write one word or phrase from the list: icons, posters, still images, videos.\n\nMP4 is an example of a file format used for __________.", "response_type": "mcq_single", "options": ["icons", "posters", "still images", "videos"], "answer": "videos"}, {"id": "JUN25-Q8", "marks": 1, "command_word": "Select", "text": "Which is an example of quantitative information?", "response_type": "mcq_single", "options": ["33", "Blue", "Television", "Workflow"], "answer": "33"}, {"id": "JUN25-Q9a", "marks": 1, "command_word": "Identify", "text": "Identify the purpose of the interactive travel magazine.", "response_type": "short_text"}, {"id": "JUN25-Q9b", "marks": 2, "command_word": "Explain", "text": "Explain what is meant by interactive media.", "response_type": "long_text"}, {"id": "JUN25-Q9c", "marks": 1, "command_word": "Identify", "text": "Identify one example of traditional media other than print publishing.", "response_type": "short_text"}, {"id": "JUN25-Q10a", "marks": 2, "command_word": "Describe", "text": "Describe one way the typography changes on the front cover of this magazine.", "response_type": "long_text", "figure": {"src": "img/jun_25_10_workplan.jpg", "alt": "Magazine cover (Question 10)"}}, {"id": "JUN25-Q10b", "marks": 2, "command_word": "Describe", "text": "Describe one way the elements are positioned to meet the purpose of this magazine cover.", "response_type": "long_text", "figure": {"src": "img/jun_25_10_workplan.jpg", "alt": "Magazine cover (Question 10)"}}, {"id": "JUN25-Q10c", "marks": 2, "command_word": "Explain", "text": "Explain one way informal language is used on this magazine cover.", "response_type": "long_text", "figure": {"src": "img/jun_25_10_workplan.jpg", "alt": "Magazine cover (Question 10)"}}, {"id": "JUN25-Q10d", "marks": 2, "command_word": "Identify", "text": "Identify two secondary research sources, other than magazines, that could be used to help plan the next issue of the interactive travel magazine.", "response_type": "short_list", "responses_required": 2}, {"id": "JUN25-Q10e", "marks": 2, "command_word": "Describe", "text": "Describe what is meant by symbolic media codes.", "response_type": "long_text"}, {"id": "JUN25-Q11a", "marks": 6, "command_word": "Explain", "text": "Explain two ways that a production manager could contribute to the production of the interactive travel magazine.", "response_type": "long_text"}, {"id": "JUN25-Q11b", "marks": 2, "command_word": "Identify", "text": "Identify two responsibilities of a creative director.", "response_type": "short_list", "responses_required": 2}, {"id": "JUN25-Q12a", "marks": 1, "command_word": "Identify", "text": "Identify the phase of production in which a graphic artist is involved.", "response_type": "short_text"}, {"id": "JUN25-Q12b", "marks": 9, "command_word": "Discuss", "text": "An asset log has been provided for the graphic artist.\n\nDiscuss the suitability of the asset log for use by the graphic artist.\n\nMarks will be awarded for:\n• Suggesting changes that improve the asset log.\n• Explaining how the changes you suggest will improve the effectiveness of the asset log for the graphic artist.", "response_type": "long_text", "figure": {"src": "img/jun_25_12b_workplan.jpg", "alt": "Asset log table"}}, {"id": "JUN25-Q12c", "marks": 1, "command_word": "Identify", "text": "Identify one piece of software that could be used to create an asset log.", "response_type": "short_text"}, {"id": "JUN25-Q13a", "marks": 2, "command_word": "Describe", "text": "Describe one action UniqJny must take to ensure photographs included in the interactive travel magazine can be used for commercial purposes.", "response_type": "long_text"}, {"id": "JUN25-Q13b", "marks": 2, "command_word": "Explain", "text": "Explain one way a photographer can protect the photographs they take from being used illegally.", "response_type": "long_text"}, {"id": "JUN25-Q13c", "marks": 2, "command_word": "Explain", "text": "Explain one reason why pixels per inch (PPI) should be considered when choosing photographs to use in the interactive magazine.", "response_type": "long_text"}, {"id": "JUN25-Q13d", "marks": 4, "command_word": "Identify/Describe", "text": "Identify two online distribution platforms. Describe one way each platform could be used to distribute a digital product.", "response_type": "short_list_with_explain", "responses_required": 2}, {"id": "JUN25-Q13e", "marks": 2, "command_word": "Explain", "text": "Explain one difference between lossy and lossless compression.", "response_type": "long_text"}, {"id": "JUN25-Q14a", "marks": 9, "command_word": "Discuss", "text": "A wireframe of the interactive index double page of the next issue of the interactive travel magazine is given to the graphic artist.\n\nONLINE VERSION NOTE: You cannot draw/annotate directly on the wireframe here.\nInstead, DISCUSS how you would improve the effectiveness of the wireframe for use by the graphic artist, describing specific improvements and explaining how each one would help.\n\nMarks will be awarded for:\n• Relevant components and conventions used\n• Layout\n• Clear justification of how your improvements help the graphic artist", "response_type": "long_text", "figure": {"src": "img/jun_25_14_workplan.jpg", "alt": "Wireframe of interactive index double page"}}, {"id": "JUN25-Q14b", "marks": 2, "command_word": "Identify", "text": "Identify two pieces of hardware required to create a wireframe.", "response_type": "short_list", "responses_required": 2}, {"id": "JUN25-Q14c", "marks": 2, "command_word": "Identify/Explain", "text": "Identify one category of audience segmentation. Explain one way this category could influence the design of the interactive travel magazine.", "response_type": "long_text"}, {"id": "JUN25-Q15", "marks": 2, "command_word": "Explain", "text": "Explain one way libel laws could affect the content of a magazine.", "response_type": "long_text"}];
  let answers = {};

  const $ = (id)=>document.getElementById(id);

  function showError(msg){
    const box = $("examLoadError");
    if(!box) return console.error(msg);
    box.style.display="block";
    box.textContent = msg;
  }
  function clearError(){
    const box = $("examLoadError");
    if(!box) return;
    box.style.display="none";
    box.textContent="";
  }

  function loadSaved(){
    try {
      const raw = localStorage.getItem(LS_KEY);
      if(raw) answers = JSON.parse(raw) || {};
    } catch(e) {}
  }
  function saveSaved(){
    try { localStorage.setItem(LS_KEY, JSON.stringify(answers)); } catch(e) {}
  }
  function setAns(qid, val){ answers[qid] = val; saveSaved(); }
  function getAns(qid, defVal){ return (qid in answers) ? answers[qid] : defVal; }

  function renderQuestion(q, idx){
    const card = document.createElement("div");
    card.className="question-card";

    const head = document.createElement("div");
    head.className="qhead";
    const meta = document.createElement("div");
    meta.className="qmeta";
    const qnum = document.createElement("div");
    qnum.className="qnum";
    qnum.textContent = `Q${idx+1}`;
    const marks = document.createElement("div");
    marks.className="qmarks";
    marks.textContent = `[${q.marks}]`;
    meta.appendChild(qnum);
    meta.appendChild(marks);

    const cmd = document.createElement("div");
    cmd.className="qcmd";
    cmd.textContent = q.command_word || "";
    head.appendChild(meta);
    head.appendChild(cmd);

    const text = document.createElement("div");
    text.className="qtext";
    text.textContent = q.text || "";

    card.appendChild(head);
    card.appendChild(text);

    if(q.figure && q.figure.src){
      const fig = document.createElement("div");
      fig.className="qfigure";
      const img = document.createElement("img");
      img.src = q.figure.src;
      img.alt = q.figure.alt || "";
      fig.appendChild(img);
      card.appendChild(fig);
    }

    const ansWrap = document.createElement("div");
    ansWrap.className="answer";

    let control;

    if(q.response_type === "mcq"){
      control = document.createElement("div");
      control.className="mcq";
      const saved = getAns(q.id, "");
      (q.options||[]).forEach(opt=>{
        const lab = document.createElement("label");
        const r = document.createElement("input");
        r.type="radio";
        r.name = `mcq_${q.id}`;
        r.value = opt.key;
        r.checked = saved === opt.key;
        r.addEventListener("change", ()=> setAns(q.id, opt.key));
        const span = document.createElement("span");
        span.textContent = `${opt.key}. ${opt.text}`;
        lab.appendChild(r);
        lab.appendChild(span);
        control.appendChild(lab);
      });
    } else if(q.response_type === "short_list") {
      const n = q.responses_required || q.expected_responses || 2;
      control = document.createElement("div");
      const saved = getAns(q.id, []);
      for(let i=0;i<n;i++) {
        const inp = document.createElement("input");
        inp.type="text";
        inp.placeholder = `Answer ${i+1}...`;
        inp.value = Array.isArray(saved) ? (saved[i] || "") : "";
        inp.addEventListener("input", ()=> {
          const arr = Array.isArray(getAns(q.id, [])) ? [...getAns(q.id, [])] : [];
          arr[i] = inp.value;
          setAns(q.id, arr);
        });
        inp.style.marginBottom = "8px";
        control.appendChild(inp);
      }
    } else if(q.response_type === "short_text") {
      control = document.createElement("input");
      control.type="text";
      control.value = getAns(q.id, "") || "";
      control.addEventListener("input", ()=> setAns(q.id, control.value));
    } else {
      // long_text fallback
      control = document.createElement("textarea");
      control.value = getAns(q.id, "") || "";
      control.addEventListener("input", ()=> setAns(q.id, control.value));
    }

    ansWrap.appendChild(control);
    card.appendChild(ansWrap);

    return card;
  }

  function renderAll(){
    const container = $("questions");
    if(!container) {
      showError("Missing #questions container in HTML.");
      return;
    }
    container.innerHTML = "";
    clearError();

    if(!Array.isArray(QUESTIONS) || !QUESTIONS.length) {
      showError("Embedded question list is empty.");
      return;
    }

    QUESTIONS.forEach((q, idx)=> container.appendChild(renderQuestion(q, idx)));

    // force submit to bottom
    const submitCard = $("submitCard");
    if(submitCard && container.parentElement) container.parentElement.appendChild(submitCard);
  }

  // Timer
  let seconds = 90*60;
  let timerInterval = null;
  function updateTimer(){
    const m = Math.floor(seconds/60);
    const s = seconds%60;
    $("timer").textContent = `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
  }
  function startTimer(){
    if(timerInterval) return;
    timerInterval = setInterval(()=> {
      if(seconds>0) seconds--;
      updateTimer();
    }, 1000);
  }
  function pauseTimer(){
    if(timerInterval) clearInterval(timerInterval);
    timerInterval = null;
  }

  async function submitToFirestore(){
    const studentName = ($("studentName").value || "").trim();
    const classCode = ($("classCode").value || "").trim();
    if(!studentName || !classCode) {
      alert("Please enter Student name and Class.");
      return;
    }

    let db, collection, addDoc, serverTimestamp;
    try {
      const cfg = await import("./firebaseConfig.js");
      db = cfg.db;
      ({ collection, addDoc, serverTimestamp } = await import("https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js"));
    } catch(e) {
      console.error(e);
      alert("Firebase failed to load. Check firebaseConfig.js is in the repo root and accessible.");
      return;
    }

    const colRef = collection(db, "exams", EXAM_ID, "submissions");
    await addDoc(colRef, {
      examId: EXAM_ID,
      studentName,
      classCode,
      answers,
      submittedAt: serverTimestamp()
    });
    alert("Submitted ✅");
  }

  function wire(){
    $("startBtn").addEventListener("click", startTimer);
    $("pauseBtn").addEventListener("click", pauseTimer);

    $("saveBtn").addEventListener("click", ()=> { saveSaved(); alert("Saved ✅"); });
    $("loadBtn").addEventListener("click", ()=> { loadSaved(); renderAll(); alert("Loaded ✅"); });
    $("resetBtn").addEventListener("click", ()=> {
      if(confirm("Reset all answers for this paper?")) {
        answers = {};
        saveSaved();
        renderAll();
      }
    });

    $("submitAttemptBtn").addEventListener("click", async ()=> {
      try { await submitToFirestore(); }
      catch(e) { console.error(e); alert("Submit failed. Check Firestore rules/network."); }
    });
  }

  document.addEventListener("DOMContentLoaded", ()=> {
    loadSaved();
    updateTimer();
    renderAll();
    wire();
  });
</script>
</body>
</html>
